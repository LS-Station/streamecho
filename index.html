<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="StreamEcho - Buffer-Free IPTV Player 2025">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.15"></script>
    <title>StreamEcho: Never Stop Player</title>
    <style>
        :root { --accent: #00D4FF; --bg: #0F0F1A; --card: #1A1A2E; --text: #E0E0FF; --light: #AAAAAA; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background: #0F0F1A; color: var(--text); padding: 1rem; }
        .player-section { max-width: 1200px; margin: 0 auto; background: var(--card); padding: 1rem; border-radius: 16px; }
        .tab-buttons { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 1rem; justify-content: center; }
        .tab-btn { padding: 10px 16px; background: rgba(0,212,255,0.1); color: var(--accent); border: 1px solid var(--accent); border-radius: 50px; font-size: 0.9rem; cursor: pointer; transition: background 0.2s, color 0.2s; }
        .tab-btn:hover { background: rgba(0,212,255,0.2); }
        .tab-btn.active { background: var(--accent); color: var(--bg); }
        .tab-content { display: none; text-align: center; }
        .tab-content.active { display: block; }
        .live-player { width: 100%; aspect-ratio: 16/9; background: #000; border-radius: 12px; margin: 1rem 0; }
        .player-title { color: var(--accent); font-weight: 600; margin: 0.5rem 0; font-size: 1.3rem; }
        .player-status { color: var(--light); font-size: 0.9rem; margin-top: 0.5rem; }
        .loading { color: #FFA41C; } .error { color: #FF3B30; }
        .retry-btn { background: #FF3B30; color: white; border: none; padding: 8px 16px; border-radius: 50px; cursor: pointer; margin-top: 10px; transition: background 0.2s; }
        .retry-btn:hover { background: #E6342D; }
        
        /* ‡¶™‡ßç‡¶∞‡¶Æ‡ßã‡¶∂‡¶®‡¶æ‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶®‡¶ó‡ßÅ‡¶≤‡¶ø‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .promo-buttons { display: flex; justify-content: center; gap: 15px; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #2A2A45; }
        .promo-btn { 
            padding: 12px 25px; 
            font-size: 1rem; 
            font-weight: 600;
            border: none; 
            border-radius: 8px; 
            cursor: pointer;
            text-decoration: none;
            text-transform: uppercase;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .promo-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }

        .website-btn { background: #4CAF50; color: white; } /* ‡¶∏‡¶¨‡ßÅ‡¶ú */
        .telegram-btn { background: #0088CC; color: white; } /* ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶®‡ßÄ‡¶≤ */

        @media (max-width: 768px) { .live-player { height: 220px; } .promo-btn { padding: 10px 18px; font-size: 0.9rem; } }
    </style>
</head>
<body>
    <div class="player-section">
        <div class="tab-buttons" id="tabButtons"></div>
        <div id="tabContents"></div>

        <div class="promo-buttons">
            <a href="https://streamecho.top" target="_blank" class="promo-btn website-btn">
                üåê ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
            </a>
            <a href="https://t.me/bdixftpiptv" target="_blank" class="promo-btn telegram-btn">
                üì¢ ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶®
            </a>
        </div>
    </div>

    <script>
        // ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü (‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßã)
        const encNames = [
            "VCBTcG9ydHMgSEQ=", "U3RhciBTcG9ydHMgMQ==", "U29saCBMaXZlIFNwb3J0cw==", "YmVJTiBTUE9SVFMgMQ=="
        ];
        const encUrls = [
            "aHR0cDovLzEwMy4xNzUuMjQyLjEwOjgwODAvdHNwb3J0czEvaW5kZXgubTN1OA==",
            "aHR0cDovLzQxLjIwNS45My4xNTQvU1RBUlNQT1JUUzEvaW5kZXgubTN1OA==",
            "aHR0cDovL2NvcnMudHVuZHJhY2FzdC5jb206MjAwMC9odHRwczovL3dvLmNtYS5mb290YmFsbGlpLmlyL2hsczIvc29saC5tM3U4",
            "aHR0cHM6Ly9iYWxhbmNlLmZvb3RiYWxsaWkuaXIvaGxzMi9iZWluMS5tM3U4"
        ];

        const channelList = encNames.map((n, i) => ({ name: atob(n), url: atob(encUrls[i]) }));

        const tabButtons = document.getElementById('tabButtons');
        const tabContents = document.getElementById('tabContents');
        let currentHls = null;
        let retryCount = 0;
        const MAX_RETRY = 10;

        // ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∏‡¶ø ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü (‡¶Ö‡¶ü‡ßã-‡¶∏‡ßÅ‡¶á‡¶ö)
        const getProxy = () => {
            const proxies = [
                'https://anywhere.pwisetthon.com/',
                'https://api.allorigins.win/raw?url=',
                'https://corsproxy.io/?',
                'https://thingproxy.freeboard.io/fetch/',
                'https://cors-anywhere.herokuapp.com/'
            ];
            return proxies[retryCount % proxies.length];
        };

        channelList.forEach((ch, i) => {
            const btn = document.createElement('button');
            btn.className = 'tab-btn';
            btn.textContent = ch.name;
            btn.onclick = () => openTab(i);
            tabButtons.appendChild(btn);

            const div = document.createElement('div');
            div.className = 'tab-content';
            div.innerHTML = `
                <div class="player-title">LIVE: ${ch.name}</div>
                <video id="video-${i}" class="live-player" controls playsinline preload="auto" muted></video>
                <div id="status-${i}" class="player-status loading">Loading... (Retry 0)</div>
                <button id="retry-${i}" class="retry-btn" style="display:none;">Retry Now</button>
            `;
            tabContents.appendChild(div);
        });

        function openTab(idx) {
            document.querySelectorAll('.tab-btn').forEach((b, i) => b.classList.toggle('active', i === idx));
            document.querySelectorAll('.tab-content').forEach((c, i) => c.classList.toggle('active', i === idx));

            if (currentHls) { currentHls.destroy(); currentHls = null; }
            retryCount = 0;

            const video = document.getElementById(`video-${idx}`);
            const status = document.getElementById(`status-${idx}`);
            const retryBtn = document.getElementById(`retry-${idx}`);
            const rawUrl = channelList[idx].url;

            video.muted = true;
            loadWithRetry(video, status, retryBtn, rawUrl);
        }

        function loadWithRetry(video, status, retryBtn, rawUrl) {
            if (retryCount >= MAX_RETRY) {
                status.textContent = '‡ßß‡ß¶ ‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ‡¶∞ ‡¶™‡¶∞‡ßá‡¶ì ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡•§ ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® (VPN) ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§';
                status.className = 'player-status error';
                retryBtn.style.display = 'block';
                retryBtn.onclick = () => { retryCount = 0; loadWithRetry(video, status, retryBtn, rawUrl); };
                return;
            }

            const proxy = getProxy();
            // ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∏‡¶ø (‡¶Ø‡ßá‡¶Æ‡¶® corsproxy.io) URL ‡¶è‡¶®‡¶ï‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá
            const proxyUrl = proxy.endsWith('?') ? proxy + rawUrl : proxy + encodeURIComponent(rawUrl); 

            status.textContent = `‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∏‡¶ø ${retryCount + 1} ‡¶¶‡¶ø‡ßü‡ßá ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...`;
            status.className = 'player-status loading';
            retryBtn.style.display = 'none';

            if (Hls.isSupported()) {
                currentHls = new Hls({
                    // **‡¶¨‡¶æ‡¶´‡¶æ‡¶∞-‡¶´‡ßç‡¶∞‡¶ø ‡¶Ö‡¶™‡¶ü‡¶ø‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®:**
                    maxBufferLength: 5, // ‡¶¨‡¶æ‡¶´‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶á‡¶ú ‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶ï‡¶Æ‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ü‡¶®‡¶æ ‡¶π‡¶≤‡ßã
                    maxMaxBufferLength: 10, // ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶¨‡¶æ‡¶´‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶á‡¶ú‡¶ì ‡¶ï‡¶Æ‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã
                    liveSyncDurationCount: 2, // ‡¶≤‡¶æ‡¶á‡¶≠ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶°‡¶ø‡¶â‡¶∞‡ßá‡¶∂‡¶® ‡ß® ‡¶∏‡ßá‡¶ó‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá ‡¶ï‡¶Æ‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã
                    lowLatencyMode: true, // ‡¶≤‡ßã-‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶®‡ßç‡¶∏‡¶ø ‡¶Æ‡ßã‡¶° ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º
                    backBufferLength: 30, // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï ‡¶¨‡¶æ‡¶´‡¶æ‡¶∞ ‡ß©‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡¶≤‡ßã
                    enableWorker: true,
                    startLevel: -1,
                    // ‡¶ï‡ßã‡¶Ø‡¶º‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø ‡¶∏‡ßÅ‡¶á‡¶ö‡¶ø‡¶Ç-‡¶è‡¶∞ ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶™‡ßá‡¶§‡ßá ‡¶è‡¶ü‡¶ø ‡¶ï‡¶Æ‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã
                    autoLevelCapping: 4, 
                    xhrSetup: (xhr) => { xhr.timeout = 15000; } // ‡¶ü‡¶æ‡¶á‡¶Æ‡¶Ü‡¶â‡¶ü ‡ßß‡ß´ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶ï‡¶Æ‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã
                });

                currentHls.loadSource(proxyUrl);
                currentHls.attachMedia(video);

                currentHls.on(Hls.Events.MANIFEST_PARSED, () => {
                    status.textContent = '‚úÖ ‡¶≤‡¶æ‡¶á‡¶≠ ‚Ä¢ ‡¶¨‡¶æ‡¶´‡¶æ‡¶∞‡¶ø‡¶Ç ‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§ ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ç';
                    status.className = 'player-status';
                    video.play().catch(e => {
                        console.log("Play failed, likely due to browser autoplay policy:", e);
                        status.textContent = '‚ùå ‡¶Ö‡¶ü‡ßã-‡¶™‡ßç‡¶≤‡ßá ‡¶¨‡ßç‡¶≤‡¶ï‡¶°! ‡¶™‡ßç‡¶≤‡ßá ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®‡•§';
                        status.className = 'player-status error';
                        // ‡¶Æ‡¶ø‡¶â‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶õ‡ßá, ‡¶§‡¶æ‡¶á ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá‡•§
                    });
                    retryCount = 0;
                });

                currentHls.on(Hls.Events.ERROR, (e, d) => {
                    if (d.fatal || d.type === 'networkError' || d.details === Hls.ErrorDetails.MANIFEST_LOAD_ERROR) {
                        console.log(`Error (Retry ${retryCount + 1}):`, d);
                        currentHls.destroy();
                        retryCount++;
                        // ‡ß© ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶™‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∏‡¶ø ‡¶¶‡¶ø‡ßü‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ
                        setTimeout(() => loadWithRetry(video, status, retryBtn, rawUrl), 3000); 
                    } else if (d.details === Hls.ErrorDetails.LEVEL_LOAD_ERROR) {
                        // ‡¶Ø‡¶¶‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶≤‡ßã‡¶° ‡¶®‡¶æ ‡¶π‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶∞‡¶ø‡¶ï‡¶≠‡¶æ‡¶∞‡¶ø ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ
                        currentHls.recoverMediaError();
                    }
                });

                video.addEventListener('waiting', () => {
                    status.textContent = '‚è≥ ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®... ‡¶¨‡¶æ‡¶´‡¶æ‡¶∞‡¶ø‡¶Ç ‡¶ö‡¶≤‡¶õ‡ßá';
                    status.className = 'player-status loading';
                });
                video.addEventListener('playing', () => {
                    status.textContent = '‚ñ∂Ô∏è ‡¶≤‡¶æ‡¶á‡¶≠ ‚Ä¢ ‡¶™‡ßç‡¶≤‡ßá ‡¶π‡¶ö‡ßç‡¶õ‡ßá';
                    status.className = 'player-status';
                });

            } else {
                // HLS.js ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶®‡¶æ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ó ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞
                video.src = proxyUrl;
                video.play();
                status.textContent = '‚ö†Ô∏è HLS.js ‡¶®‡ßá‡¶á, ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶™‡ßç‡¶≤‡ßá‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡•§';
                status.className = 'player-status error';
            }
        }

        setTimeout(() => {
            if (channelList.length > 0) openTab(0);
        }, 500);
    </script>
</body>
</html>
